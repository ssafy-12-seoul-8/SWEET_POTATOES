# [Gold IV] 문자열 지옥에 빠진 호석 - 20166 

[문제 링크](https://www.acmicpc.net/problem/20166) 

### 성능 요약

메모리: 58328 KB, 시간: 316 ms

### 분류

자료 구조, 깊이 우선 탐색, 다이나믹 프로그래밍, 그래프 이론, 그래프 탐색, 해시를 사용한 집합과 맵

### 제출 일자

2024년 10월 20일 22:00:16

### 문제 설명

<p><em>하루 종일 내리는 비에 세상이 출렁이고 구름이 해를 먹어 밤인지 낮인지 모르는 어느 여름 날</em></p>

<p>잠 들기 싫어 버티던 호석이는 무거운 눈꺼풀에 패배했다. 정신을 차려보니 바닥에는 격자 모양의 타일이 가득한 세상이었고, 각 타일마다 알파벳 소문자가 하나씩 써있다더라. 두려움에 가득해 미친듯이 앞만 보고 달려 끝을 찾아 헤맸지만 이 세상은 끝이 없었고, 달리다 지쳐 바닥에 드러누우니 하늘에 이런 문구가 핏빛 구름으로 떠다니고 있었다.</p>

<ul>
	<li>이 세상은 <em>N</em>행 <em>M</em>열의 격자로 생겼으며, 각 칸에 알파벳이 써있고 환형으로 이어진다. 왼쪽 위를 (1, 1), 오른쪽 아래를 (<em>N</em>, <em>M</em>)이라고 하자.</li>
	<li>너는 아무 곳에서나 시작해서 상하좌우나 대각선 방향의 칸으로 한 칸씩 이동할 수 있다. 이 때, 이미 지나 왔던 칸들을 다시 방문하는 것은 허용한다.</li>
	<li>시작하는 격자의 알파벳을 시작으로, 이동할 때마다 각 칸에 써진 알파벳을 이어 붙여서 문자열을 만들 수 있다.</li>
	<li>이 곳의 신인 내가 좋아하는 문자열을 <em>K </em>개 알려줄 터이니, 각 문자열 마다 너가 만들 수 있는 경우의 수를 잘 대답해야 너의 세계로 돌아갈 것이다.</li>
	<li>경우의 수를 셀 때, 방문 순서가 다르면 다른 경우이다. 즉, (1,1)->(1,2) 로 가는 것과 (1,2)->(1,1) 을 가는 것은 서로 다른 경우이다.</li>
</ul>

<p>호석이는 하늘을 보고서 <em>"환형이 무엇인지는 알려달라!" </em>며 소리를 지르니 핏빛 구름이 흩어졌다가 모이며 아래와 같은 말을 그렸다.</p>

<ul>
	<li>너가 1행에서 위로 가면 <em>N </em>행으로 가게 되며 반대도 가능하다.</li>
	<li>너가 1열에서 왼쪽으로 가면 <em>M</em> 열로 가게 되며 반대도 가능하다.</li>
	<li>대각선 방향에 대해서도 동일한 규칙이 적용된다.</li>
	<li>하늘에 아래와 같은 그림을 구름으로 그려줄 터이니 이해해 돕도록 하여라.</li>
	<li>예를 들어서, 너가 (1, 1)에서 위로 가면 (<em>N</em>, 1)이고, 왼쪽으로 가면 (1, <em>M</em>)이며 왼쪽 위 대각선 방향으로 가면 (<em>N</em>, <em>M</em>)인 것이다.</li>
</ul>

<p><img alt="" src="https://upload.acmicpc.net/3701860f-0ca1-45a8-8f99-ad149d1f5771/-/preview/" style="height: 327px; width: 400px;"></p>

<p>세상을 이루는 격자의 정보와, <em>K</em> 개의 문자열이 주어졌을 때, 호석이가 대답해야 하는 정답을 구해주도록 하자.</p>

### 입력 

 <p>첫번째 줄에 격자의 크기 <em>N</em>, <em>M</em>과 신이 좋아하는 문자열의 개수 <em>K </em>가 주어진다.</p>

<p>다음에 <em>N</em>개의 줄에 걸쳐서 M개의 알파벳 소문자가 공백없이 주어진다. 여기서의 첫 번째 줄은 1행의 정보이며, <em>N</em> 번째 줄은 <em>N</em>행의 정보이다.</p>

<p>이어서 <em>K</em>개의 줄에 걸쳐서 신이 좋아하는 문자열이 주어진다. 모두 알파벳 소문자로 이루어져 있다.</p>

### 출력 

 <p><em>K</em>개의 줄에 걸쳐서, 신이 좋아하는 문자열을 만들 수 있는 경우의 수를 순서대로 출력한다.</p>

